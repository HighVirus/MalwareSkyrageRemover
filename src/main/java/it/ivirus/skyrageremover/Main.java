package it.ivirus.skyrageremover;


import java.io.File;
import java.util.List;

import it.ivirus.skyrageremover.jar.JarCleaner;
import it.ivirus.skyrageremover.system.OperatingSystem;
import it.ivirus.skyrageremover.system.SystemCleaner;

public class Main {

	private static void printWelcomeMessage() {
		System.out.println();
		System.out.println(":::    :::  ::::::::  :::    ::: ::::::::::: :::::::::::     :::     ");
		System.out.println(":+:    :+: :+:    :+: :+:    :+:     :+:         :+:       :+: :+:   ");
		System.out.println("+:+    +:+ +:+    +:+  +:+  +:+      +:+         +:+      +:+   +:+  ");
		System.out.println("+#++:++#++ +#+    +:+   +#++:+       +#+         +#+     +#++:++#++: ");
		System.out.println("+#+    +#+ +#+    +#+  +#+  +#+      +#+         +#+     +#+     +#+ ");
		System.out.println("#+#    #+# #+#    #+# #+#    #+#     #+#     #+# #+#     #+#     #+# ");
		System.out.println("###    ###  ########  ###    ### ###########  #####      ###     ### ");
		System.out.println();
		System.out.println(ConsoleColors.CYAN + "Developer: iVirus_");
		System.out.println("Telegram: https://t.me/HoxijaChannel");
		System.out.println("Discord: https://discord.io/hoxija");
		System.out.println("Version: 1.5-BETA" + ConsoleColors.RESET);
		System.out.println();
	}

	public static void main(String[] args) throws Throwable {

		printWelcomeMessage();

		Options options = Options.readOptions();

		if (options.isCleanJars()) {
			System.out.println("Searching infected jars...");
			System.out.println();

			List<File> infectedJars = JarCleaner.findInfectedJars(new File("someFile").getAbsoluteFile().getParentFile());

			System.out.println();
			System.out.println("Total jars infected: " + infectedJars.size());
			System.out.println();

			System.out.println();
			System.out.println("Cleaning jars...");
			System.out.println();

			for (File jar : infectedJars) {
				System.out.print("Cleaning " + jar.getName() + "...");
				JarCleaner.cleanJar(jar, options.isReplaceJars());
				System.out.println(" [DONE]");
			}
		}

		if (options.isCleanSystem()) {
			System.out.println();
			System.out.println("Cleaning system...");
			System.out.println();

			OperatingSystem system = OperatingSystem.getSystem();
			SystemCleaner cleaner = system.getCleaner();
			SystemInfectionType infectionType = cleaner.getInfectionType();
			if (infectionType != SystemInfectionType.CLEAN) {
				System.out.println("Your system seems to be compromised by Skyrage malware.");
				System.out.println("I'm cleaning your OS.");
				cleaner.clean(infectionType);
			} else {
				System.out.println("Your system does not seems to be compromised by Skyrage malware.");
			}
		}
	}
}
